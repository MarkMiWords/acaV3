<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Captive Audience</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="manifest" href="/manifest.json">
</head>
<body>
  <!-- Main Workspace Container -->
  <div class="forge-workspace">

    <!-- Left Panel: Navigator -->
    <aside class="navigator-panel" id="navigator">
      <div class="navigator-actions">
        <button id="new-sheet-btn" class="nav-action-btn">New Sheet</button>
        <button id="live-link-btn" class="nav-action-btn">Live Link</button>
      </div>

      <div class="nav-section">
        <span class="nav-link" id="sync-diagnostic">Sync Diagnostic</span>
      </div>

      <div class="nav-section currently-editing">
        <span class="nav-label">Currently Editing:</span>
        <span class="nav-editing-title" id="current-editing-title">Untitled Sheet</span>
      </div>

      <div class="sheet-list-container">
        <ul id="sheet-list" class="sheet-list">
          <!-- Sheets will be dynamically inserted here -->
        </ul>
      </div>
    </aside>

    <!-- Resizer between Navigator and Sheet -->
    <div class="resizer" data-resizer="left"></div>

    <!-- Center Panel: Sheet Editor with WRAP Hub -->
    <main class="sheet-panel" id="sheet-panel">
      <!-- WRAP Hub -->
      <div class="wrap-hub">
        <span class="wrap-hub-label">WRAP</span>
        <div class="wrap-hub-buttons">
          <div class="wrap-btn-group">
            <button class="wrap-hub-btn active" data-wrap="write">
              <span class="wrap-letter">W</span>rite
            </button>
          </div>
          <div class="wrap-btn-group">
            <button class="wrap-hub-btn" data-wrap="revise">
              <span class="wrap-letter">R</span>evise
              <span class="wrap-arrow">&#9662;</span>
            </button>
            <div class="wrap-dropdown" id="dropdown-revise">
              <button id="rinse-btn" class="wrap-dropdown-item" title="Remove double spaces, normalize punctuation">
                <span class="dropdown-item-title">Rinse</span>
                <span class="dropdown-item-desc">Surface clean — spacing, punctuation, typos</span>
              </button>
              <button id="wash-btn" class="wrap-dropdown-item" title="Suggest paragraph breaks">
                <span class="dropdown-item-title">Wash</span>
                <span class="dropdown-item-desc">Clarity — paragraphs, readability, repetition</span>
              </button>
              <button id="scrub-btn" class="wrap-dropdown-item disabled" title="Structural suggestions (coming soon)" disabled>
                <span class="dropdown-item-title">Scrub</span>
                <span class="dropdown-item-desc">Structure — order, transitions, trimming</span>
              </button>
            </div>
          </div>
          <div class="wrap-btn-group">
            <button class="wrap-hub-btn" data-wrap="articulate">
              <span class="wrap-letter">A</span>rticulate
              <span class="wrap-arrow">&#9662;</span>
            </button>
            <div class="wrap-dropdown" id="dropdown-articulate">
              <button id="calibrate-clone-btn" class="wrap-dropdown-item">
                <span class="dropdown-item-title">Calibrate My Clone</span>
                <span class="dropdown-item-desc">Train your voice profile</span>
              </button>
              <div class="dropdown-divider"></div>
              <div class="calibration-group">
                <label class="calibration-label">Gender Matrix</label>
                <div class="calibration-toggles" id="gender-matrix">
                  <button class="toggle-btn" data-value="M">M</button>
                  <button class="toggle-btn" data-value="F">F</button>
                  <button class="toggle-btn active" data-value="M2">M</button>
                </div>
              </div>
              <div class="calibration-group">
                <label class="calibration-label">Calibration Tone</label>
                <div class="calibration-toggles" id="calibration-tone">
                  <button class="toggle-btn" data-value="S">S</button>
                  <button class="toggle-btn active" data-value="M">M</button>
                  <button class="toggle-btn" data-value="L">L</button>
                </div>
              </div>
              <div class="calibration-group">
                <label class="calibration-label">Regional Accent</label>
                <div class="calibration-toggles" id="regional-accent">
                  <button class="toggle-btn active" data-value="AU">AU</button>
                  <button class="toggle-btn" data-value="UK">UK</button>
                  <button class="toggle-btn" data-value="US">US</button>
                </div>
              </div>
              <button id="apply-transformation-btn" class="wrap-dropdown-action">Apply Transformation</button>
            </div>
          </div>
          <div class="wrap-btn-group">
            <button class="wrap-hub-btn" data-wrap="publish">
              <span class="wrap-letter">P</span>ublish
              <span class="wrap-arrow">&#9662;</span>
            </button>
            <div class="wrap-dropdown" id="dropdown-publish">
              <button class="wrap-dropdown-item disabled" disabled>
                <span class="dropdown-item-title">Prison Newspaper</span>
                <span class="dropdown-item-desc">Format for prison newspaper submission</span>
              </button>
              <button class="wrap-dropdown-item disabled" disabled>
                <span class="dropdown-item-title">Substack Story</span>
                <span class="dropdown-item-desc">Format for online publication</span>
              </button>
              <button class="wrap-dropdown-item disabled" disabled>
                <span class="dropdown-item-title">Letter</span>
                <span class="dropdown-item-desc">Format as a letter</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Sheet Editor (always visible) -->
      <div class="sheet-header">
        <input
          type="text"
          id="sheet-title"
          class="sheet-title-input"
          placeholder="Untitled Sheet"
          maxlength="100"
        >
      </div>

      <div
        id="sheet-editor"
        class="sheet-editor"
        contenteditable="true"
        spellcheck="true"
        data-placeholder="Start writing..."
      ></div>
    </main>

    <!-- Resizer between Sheet and WRAP Partner -->
    <div class="resizer" data-resizer="right"></div>

    <!-- Right Panel: WRAP Partner -->
    <aside class="partner-panel" id="partner-panel">
      <div class="partner-header">
        <h2>Wrap Partner</h2>
      </div>

      <div id="partner-messages" class="partner-messages">
        <div class="partner-message system">
          <p>Welcome to The Forge. I'm here to help you express your words.</p>
        </div>
      </div>

      <div class="partner-input-area">
        <textarea
          id="partner-input"
          class="partner-input"
          placeholder="Ask for help or guidance..."
          rows="3"
        ></textarea>
        <button id="partner-send-btn" class="primary-btn">Send</button>
      </div>
    </aside>

  </div>

  <!-- Bottom Status Bar -->
  <div class="status-bar" id="status-bar">
    <span class="status-item" id="status-words">Words: 0</span>
    <span class="status-item" id="status-context">Context: Australia</span>
    <span class="status-item" id="status-style">Style: Prison Life</span>
    <span class="status-item" id="status-vault">Vault Secured</span>
    <span class="status-item status-forge">Forge VT.5 Alchemist</span>
  </div>

  <!-- Word Limit Warning Modal -->
  <div id="word-warning-modal" class="modal hidden">
    <div class="modal-content">
      <h3>Approaching word limit</h3>
      <p>You're at <span id="warning-word-count">900</span> words. Consider wrapping up this scene or creating a new sheet.</p>
      <button id="close-warning-btn" class="primary-btn">Continue Writing</button>
      <button id="new-sheet-from-warning-btn" class="secondary-btn">Create New Sheet</button>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
